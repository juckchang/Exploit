# DIMICTF 2018 - c2w2m2 (12180P, 1th)

![1th.PNG](1th.PNG)

## List
- Pwn
    - init
    - treefrog
    - babycpp
    - what
- Rev
    - EZPZ
    - mm
- Web
    - DIMI SIMPLE BOARD1
    - DIMI SIMPLE BOARD2
    - Boxipreter
    - easy curl
    - easy login
- Misc
    - Mic Check
    - Number Baseball
    - Win RSP
    - guess
     
## Pwn

### init

처음 input으로 첫바이트를 \x00 으로 바꿔서 주소를 좀 앞으로 옮기고
100byte정도 읽어주면 플래그가 끼어 나온다

[exp.py](./pwn/init.py)

[쉘딴 이미지]()

Flag : ~~~

### treefrog

바로 bof를 준다. payload를 뒤집는데, 이는 처음에 \x00을 넣어, strlen을 0 으로 만듬으로써 우회할 수 있다.

[return to csu](http://tech.c2w2m2.com/pwn/return-to-csu/) 로 풀었다.

[exp.py](./pwn/treefrog.py)

[쉘딴 이미지]()

Flag : ~~~

### babycpp

cpp라서 처음에 조금 당황했는데, 어렵지 않았다.

단순히 UAF가 터지고, Vuln생성시 함수 포인터가 같이 생기며, Shell을 생성시 shell을 얻을 수 있는 함수의 주소를 넣어주니까

1. Vuln  생성
2. Vuln  삭제
3. Shell 생성 => Vuln의 함수 포인터 조작
4. Vuln  호출

하면 풀리게 된다.

[쉘딴 이미지]()

Flag : ~~~

### what

integer overflow를 이용하는 oob 문제이다. 크게 어렵지 않았다.

Payload : 

[쉘딴 이미지]()

Flag : ~~~

## Rev

### ezpz

.NET으로 만들어졌다. dotpeek로 열어서 확인해보면
```
private void button1_Click(object sender, EventArgs e)
    {
      if (string.Compare(this.INPUT.Text, "Welcome_reversing") != 0)
        return;
      int num = (int) MessageBox.Show("dimi{" + this.INPUT.Text + "}");
    }
```
다음과 같은 코드가 있다.

Flag : dimi{Welcome_reversing}

### mm

```
srand(0x17A3u); 
```
같은 시드로 srand 를 하고

```
v4 = strlen(a1);
memset(s1, 0, 0x200uLL);
for ( i = 0; i < v4; ++i )
{
    v1 = (unsigned __int16)rand();
    s1[i] = v1 * a1[i] % (v1 + 1);
}
return memcmp(s1, &unk_201020, 0x74uLL) == 0;
```
다음과 같은 연산으로 테이블과 맞는지 확인한다.

그래서 unk_201020테이블을 꺼내와서 역연산을 진행 해주면 되는데, 내가 멍청해서 역연산을 짜려다가 답없어서 for로 다 넣어봤다.

[solver.py](./rev/mm.py)

Flag : dimi{ca1cul4t3d_inv3rs3?_0r_us3d_z3?_0h_y0u_ar3_4_F0Ol_;)}

## Web

### DIMI SIMPLE BOARD1

글을 읽는 idx에서 union based sqli가 가능해서, 이걸로 비밀글을 읽으면 된다.

sqlmap 돌렸다.

```
sqlmap -u "http://URL/read.php?idx=1" --threads=10 --random-agent  --dbs -D board --tables --dump 
```

![board1](./web/BOARD1.png)

Flag : dimigo{dimi_qna_sqlinjection}

