from pwn import *

def parser(data):
    res = ''
    data = data[data.find(" ") + 1 :]
    res += data[0] + ' '
    data = data[data.find("L ") + 2 :]
    res += data[0]
    return res

if __name__ == '__main__':
    p = remote('121.170.91.16', 9623)
    p.recvuntil("E ==================")
    f=0
    for i in range(0, 21):
        context.log_level='debug'
        if f == 0:
            p.recvuntil("GUESS > ")
        else:
            f=0
        q = process("./solver.py")
        q.recvuntil("Question")
        for j in range(1,10):
            data = q.recvline()
            if "Your number is " in data:
                data = data[data.find("is ") + 3 :]
                send = data[0] + ' ' + data[1] + ' ' + data[2] + ' ' + data[3]
                p.sendline(send)
                break
            data = data[data.find(": ")+2:]
            send = data[0] + ' ' + data[1] + ' ' + data[2] + ' ' + data[3]
            p.sendline(send)
            res = p.recvuntil("STR")
            res = p.recvline()
            res = res[res.find("> ") + 2:]
            print res
            p.recvuntil("> ")
            data = parser(res)
            if data == '4 0':
                f=1
                break
            q.sendline(data)
        q.close()
